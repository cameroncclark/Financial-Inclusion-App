package View;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.Serializable;
import java.util.Calendar;
import java.util.Observable;
import java.util.Observer;

import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

import Controller.ActionController;

public class CategoriesPanel implements Panel, Observer {
	JPanel panel;
	ActionController actionListener;
	String[] categories;
	JTextField addCTF;
	JTextField editCTF;
	JComboBox editCatList;

	public CategoriesPanel(ActionController actionListener) {
		this.actionListener = actionListener;
		createPanel();
	}

	public void createPanel() {
		categories = actionListener.initaliseCategoriesTab();
		panel = new JPanel();
		panel.setVisible(true);
		panel.setLayout(null);

		// Add Category Functionality******************
		JLabel addCategoryLbl = new JLabel("Add Category:");
		addCategoryLbl.setBounds(2, 2, 200, 20);

		addCTF = new JTextField();
		addCTF.setBounds(2, 50, 150, 20);

		JButton addCategoryBtn = new JButton("Add Category");
		addCategoryBtn.setBounds(500, 70, 125, 20);
		addCategoryBtn.setActionCommand("addCategory");
		addCategoryBtn.addActionListener(actionListener);

		panel.add(addCategoryLbl);
		panel.add(addCTF);
		panel.add(addCategoryBtn);

		// Edit Category Functionality*********************
		JLabel editCategoryLbl = new JLabel("Edit Category:");
		editCategoryLbl.setBounds(2, 102, 200, 20);

		editCatList = new JComboBox(categories);
		editCatList.setSelectedIndex(0);
		editCatList.addActionListener(actionListener);
		editCatList.setActionCommand("editCategorySelect");
		editCatList.setBounds(2, 120, 250, 25);
		editCatList.addActionListener(new ActionListener() {

			@Override
			public void actionPerformed(ActionEvent e) {
				editCTF.setText(editCatList.getSelectedItem().toString());
			}
		});

		editCTF = new JTextField();
		editCTF.setBounds(2, 150, 150, 20);
		editCTF.setText(editCatList.getSelectedItem().toString());

		JButton editCategoryBtn = new JButton("Edit Category");
		editCategoryBtn.setBounds(500, 120, 125, 20);
		editCategoryBtn.setActionCommand("editCategory");
		editCategoryBtn.addActionListener(actionListener);

		panel.add(editCategoryLbl);
		panel.add(editCTF);
		panel.add(editCategoryBtn);

		JLabel deleteCategoryLbl = new JLabel("Delete Category:");
		deleteCategoryLbl.setBounds(2, 202, 200, 20);
		panel.add(deleteCategoryLbl);

		panel.add(editCatList);
	}

	public String getAddCategoryText() {
		return addCTF.getText();
	}

	public void clearAddCategoryText() {
		addCTF.setText("");
	}

	public JComponent getPanel() {
		return panel;
	}

	public String getGetSelectedEditItem() {
		return editCatList.getSelectedItem().toString();
	}

	@Override
	public void update(Observable o, Object arg) {
		categories = actionListener.initaliseCategoriesTab();
		refreshComboBoxes();
		panel.repaint();
		panel.revalidate();
	}

	public void refreshComboBoxes() {
		panel.remove(editCatList);
		editCatList = new JComboBox(categories);
		editCatList.setSelectedIndex(0);
		editCatList.addActionListener(actionListener);
		editCatList.setActionCommand("editCategorySelect");
		editCatList.setBounds(2, 120, 250, 25);
		editCatList.setVisible(true);
		editCatList.addActionListener(new ActionListener() {

			@Override
			public void actionPerformed(ActionEvent e) {
				editCTF.setText(editCatList.getSelectedItem().toString());
			}
		});
		editCTF.setText(editCatList.getSelectedItem().toString());
		
		panel.add(editCatList);
	}
	
	public String getSelectedItem(){
		return editCatList.getSelectedItem().toString();
	}

}
