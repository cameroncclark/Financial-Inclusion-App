package Model;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Random;

import com.google.gson.Gson;

import ContentObjects.Category;

public class CategoriesModel {
	final String _PATH = "../../FinancialInclusionApplication/www/content/";
	Gson gson;
	ArrayList<Category> categories;
	Model model; 
	Random random;
	
	public CategoriesModel(Model model) {
		this.model = model;
		gson = new Gson();
		random = new Random();
		selectCategories();
	}
	
	public String[] selectCategories() {
		try {
			String fileText = getJSONString("categories.JSON");

			Category[] categoryArray = gson.fromJson(fileText, Category[].class);
			categories = new ArrayList<Category>(Arrays.asList(categoryArray));

			String[] categoryNames = new String[categoryArray.length];
			int count = 0;
			for (Category category : categoryArray) {
				categoryNames[count] = category.getName();
				count++;
			}
			System.out.println(gson.toJson(categories));
			return categoryNames;

		} catch (Exception e) {
			e.printStackTrace();
		}
		return new String[] {};
	}
	
	private Boolean duplicateName(String name) {
		for (Category c : categories) {
			if (c.getName().equals(name)) {
				return true;
			}
		}
		return false;
	}
	
	// Need check to see if category name is in there
		public void addCategory(String categoryName) {
			System.out.println("Add category called");
			if (!duplicateName(categoryName)) {
				System.out.println("Not duplicate");
				int newCatId = random.nextInt(500) + 1;
				while (getCategoryIDs().contains(newCatId)) {
					newCatId = random.nextInt(500) + 1;
				}
				categories.add(new Category(categoryName, newCatId));
				rewriteCategoriesFile();
			}
			System.out.println("Add categories: " +gson.toJson(categories));
		}

}
